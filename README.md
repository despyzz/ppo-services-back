# PPO Services: Deploy Guide

## Быстрый деплой в production (Docker)

1. **Клонируйте репозиторий и перейдите в папку проекта:**
   ```bash
   git clone <repo-url>
   cd ppo-services-back
   ```

2. **Создайте .env либо экспортируйте переменные окружения:**
   - `PORT` (по умолчанию 3000)
   - `JWT_SECRET` (обязательно задайте свой)

3. **Соберите Docker-образ:**
   ```bash
   docker build -t ppo-admin .
   ```

4. **Запустите контейнер:**
   ```bash
   docker run -d --name ppo-admin -p 3000:3000 \
     -e JWT_SECRET=your-secret \
     -v $(pwd)/db:/app/db \
     -v $(pwd)/documents:/app/documents \
     -v $(pwd)/images:/app/images \
     ppo-admin
   ```

- `-v ...:/app/db` — маунты для сохранности базы и файлов
- `-e` — передача секрета токена (обязателен)
- `-p` — публикация порта (3000 по умолчанию)

## Ручное создание администратора

Сервер не создает дефолтного пользователя автоматически!
Чтобы добавить администратора, используйте:
```bash
node scripts/add-admin.js <username> <password>
```
- Можно добавить несколько админов разными вызовами.
- Для production используйте уникальные, надежные пароли.
- Админ не должен храниться в публичном репозитории!

5. **Откройте браузер:**
   - `http://<адрес_вашего_сервера>:3000/public/index.html`
   - Логин по заранее созданному администратору (создается дефолтно при первом старте, если база пуста)

6. **Для обновления:**
   ```bash
   docker pull <image> # (если обновлено в registry)
   docker stop ppo-admin && docker rm ppo-admin
   docker build -t ppo-admin . # или заново билд
   docker run ... # как выше
   ```
---

**Рекомендации безопасности:**
- Храните db/, documents/, images/ в volumes/ на хосте
- Не заводите регистрацию через интерфейс, только через БД или миграции
- Делайте периодический бэкап папок db/, documents/, images/

---

Сервис готов к деплою в прод-окружение.
